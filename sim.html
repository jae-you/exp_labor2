<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8">
<style>
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body { background: #1e1e1e; color: #e0e0e0; font-family: sans-serif; overflow: hidden; }
  #app { display: flex; height: 100vh; padding: 20px; flex-direction: column; align-items: center; justify-content: center; }
  .opt-card { background: #333; padding: 15px; margin: 10px; cursor: pointer; border-radius: 8px; border: 1px solid #444; width: 300px; text-align: center; }
  #deploy-btn { padding: 12px 40px; background: #28a745; color: white; border: none; border-radius: 6px; cursor: pointer; margin-top: 20px; font-weight: bold; }
  #report { display: none; width: 100%; height: 100vh; background: #141414; padding: 40px; flex-direction: column; align-items: center; justify-content: center; text-align: center; }
  /* íŒŒë€ ë²„íŠ¼ ê´€ë ¨ ìŠ¤íƒ€ì¼(submit-zone ë“±)ì€ ì•„ì˜ˆ ì‚­ì œí•¨ */
</style>
</head>
<body>

<div id="app">
  <h2 id="mod-title"></h2>
  <p id="mod-desc" style="color: #aaa; margin: 10px 0 20px;"></p>
  <div id="opt-grid" style="display: flex; gap: 10px;"></div>
  <button id="deploy-btn" onclick="doDeploy()">ğŸš€ Deploy Module</button>
</div>

<div id="report">
  <h1 style="color: #007acc; margin-bottom: 15px;">ğŸ“Š Architecture Analysis Complete</h1>
  <p style="font-size: 18px; color: #fff;">ì•„í‚¤í…ì²˜ ì„¤ê³„ ë¶„ì„ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.</p>
  <p style="color: #666; margin-top: 10px;">ë°ì´í„°ë¥¼ ì •ë¦¬í•˜ì—¬ Phase 2(ì„¤ê³„ê¸°ìˆ ì„œ)ë¡œ ì•ˆì „í•˜ê²Œ ì´ë™í•©ë‹ˆë‹¤...</p>
</div>

<script>
var CONFIG = window.SIM_CONFIG || { userName: '' };
var TASKS = window.SIM_TASKS || [];
var step = 0; var deployHistory = []; var metrics = { agency: 0, inclusion: 0, sustain: 0, eff: 0 }; var selected = null;

function renderStep() {
  if (step >= TASKS.length) { showReport(); return; }
  var t = TASKS[step]; document.getElementById('mod-title').textContent = t.title; document.getElementById('mod-desc').textContent = t.desc;
  var g = document.getElementById('opt-grid'); g.innerHTML = '';
  t.options.forEach(o => {
    var c = document.createElement('div'); c.className = 'opt-card'; c.innerHTML = `<b>${o.label}</b>`;
    c.onclick = () => { document.querySelectorAll('.opt-card').forEach(x => x.style.borderColor = '#444'); c.style.borderColor = '#007acc'; selected = o; };
    g.appendChild(c);
  });
}

function doDeploy() {
  if (!selected) return;
  var t = TASKS[step]; metrics[t.metric] += selected.human; metrics.eff += selected.eff;
  deployHistory.push({ step: step + 1, choice: selected.label });
  step++; selected = null; renderStep();
}

function showReport() {
  document.getElementById('app').style.display = 'none';
  document.getElementById('report').style.display = 'flex';
  
  // [ì¤‘ìš”] ì‹œë®¬ë ˆì´ì…˜ ë°ì´í„°ë¥¼ JSONìœ¼ë¡œ ë³€í™˜
  var simResult = JSON.stringify({ history: deployHistory, scores: metrics });
  
  // 2ì´ˆ ë’¤ì— ë¶€ëª¨(Streamlit) URLì„ ë³€ê²½í•˜ë©´ì„œ ë°ì´í„°ë¥¼ ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°ë¡œ ì „ë‹¬
  setTimeout(function() {
    var parentUrl = window.parent.location.origin + window.parent.location.pathname;
    window.parent.location.href = parentUrl + "?sim_result=" + encodeURIComponent(simResult);
  }, 2000);
}

renderStep();
</script>
</body>
</html>
